📑 SpreadSheets

## 🗂️ 스프레드시트란 ?

- **스프레드시트 :** 데이터를 표로 정리해 계산·분석·시각화까지 할 수 있는 도구
    
    대표: 구글 스프레드시트, 엑셀
    
- **왜 쓰나 ?**
    - 오늘 날씨 보고 옷 고르기 🌤️
    - 배달 앱에서 별점 높은 집 선택 🍕⭐️
        
        👉 이런 것도 다 데이터 분석!
        

### ✅ 주요 특징

- 구글 스프레드시트
    - 무료 💸
    - 온라인 실시간 협업 🔗
    - 100만 행 이상 한계 있음 ⚠️
    - 고급 통계 기법은 어려움 → 가볍고 빠르게 !
- 기본 구조
    - **행(Row)** : 가로줄 (1, 2, 3…)
    - **열(Column)** : 세로줄 (A, B, C…)
    - **셀(Cell)** : 행과 열이 만나는 한 칸
    - **헤더(Header)** : 표의 맨 위 제목줄

---

## 📌 **핵심 함수**

| 목적 | 함수 | 설명 |
| --- | --- | --- |
| 합계 | `=SUM(범위)` | 숫자 합산 |
| 평균 | `=AVERAGE(범위)` | 평균값 구하기 |
| 개수 | `=COUNT(범위)` | 숫자가 있는 셀 개수 |
| 최대값 | `=MAX(범위)` | 가장 큰 값 |
| 최소값 | `=MIN(범위)` | 가장 작은 값 |
| 중간값 | `=MEDIAN(범위)` | 중앙값 |
| 조건부 개수 | `=COUNTIF(범위, 조건)` | 조건을 만족하는 셀 개수 |
| 조건부 합계 | `=SUMIF(조건범위, 조건, 합계범위)` | 조건 만족하는 값만 합산 |
| 복합 조건 | `=COUNTIFS(조건1범위, 조건1, 조건2범위, 조건2)` | 여러 조건을 동시에 만족하는 개수 |

---

## 🧹 **데이터 정제**

- **에러 처리**
    - `#DIV/0!` : 0으로 나눌 때 → `=IF(B1=0,"계산불가", A1/B1)`
    - `#NAME?` : 함수 오타 → 함수명 확인!
    - `#REF!` : 참조 오류 → 범위 재확인
    - `#N/A` : 값 없음 → `IFERROR()`로 대체값 처리

- **빈 셀 처리**
    - `=ISBLANK(셀)` : 빈 셀 확인
    - `=COUNTBLANK(범위)` : 빈 셀 개수 세기
    - `=IF(ISBLANK(A2),"기본값",A2)` : 빈 셀일 때 기본값 입력

- **데이터 형식 변환**
    - 숫자로 변환 : `=VALUE(문자)`
    - 텍스트 결합 : `=CONCATENATE(A2,B2)` 또는 `=A2&B2`
    - 왼쪽/오른쪽/중간 문자 : `=LEFT()`, `=RIGHT()`, `=MID()`

- **중복 제거 & 조건부 서식**
    - 중복 찾기 : `=COUNTIF(범위, 기준셀)>1`
    - 중복 제거 : 데이터 → 중복 항목 삭제

- **REGEX(정규식)** → 더 복잡한 패턴에 사용

---

## 🔍 기본 필터 & 동적 필터

- 기본 필터: 데이터 → 필터 만들기
- 조건별 필터: 헤더 화살표 클릭
- 동적 필터: `=FILTER(범위, 조건)`
    - 복합 조건: `=FILTER(A2:D8, (B2:B8="전자제품")*(C2:C8>10000))`

---

## 🕵️‍♀️ 이상값 탐지

- Z-Score: `=(값 - 평균) / 표준편차`
- 이상값 여부: `=IF(ABS(Z점수)>2.5,"이상값","정상")`
- 이상값 처리: 평균 대체, 중간값 대체, 윈저화(Winsorizing)
    - 예: 상위 5% → 95% 값으로 대체

---

## 🧮 **텍스트 & 조건 함수**

- 텍스트 결합: `=A2&B2` 또는 `=CONCATENATE()`
- LEFT/RIGHT/MID 로 부분 추출
- 조건문: `=IF()`, `=IFS()`

---

## 🔗 데이터 연결 & 참조

- **`=VLOOKUP(찾을값, 테이블범위, 열번호, FALSE)`**
    - 다른 표에서 원하는 값 찾아오기 (전화번호부처럼!)
    - 필수: 찾을 값이 테이블의 첫 번째 열에 있어야 함
- **`=IF(조건, 참, 거짓)`**
    - 조건문
- **`=IFS(조건1, 값1, 조건2, 값2, TRUE, 기본값)`**
    - 다중 조건문
- 절대 참조: **`$`** 사용 (**`$A$1`**) → ‘복사 붙여 넣기’ 해도 고정됨

---

## 📈 **시각화**

| 차트 | 용도 | 예시 |
| --- | --- | --- |
| 막대 | 카테고리 비교 | 부서 별 매출 |
| 선 | 시간 추세 | 월 별 성장 |
| 원 | 구성비 | 시장 점유율 |
| 산점도 | 상관 관계 | 광고비 vs 매출 |
| 히스토그램 | 분포 | 고객 연령대 |

**팁:**

- 추세선 + R² 값 → 데이터 예측력 체크!
- 원 차트는 구성비만, 비교는 막대나 선 차트!

---

## ⚠️ **검증 및 안전 가이드**

- 원본 데이터 백업!
- 계산 로직 기록!
- WHERE 절 & 조건 필수로 쓸 것!
- `IFERROR`로 에러 처리!
- `DROP TABLE IF EXISTS` 같은 방어 코드 습관!

---

## **🧐 심화 | 고급 활용**

### **📌 ARRAYFORMULA**

- 여러 셀 한 번에 계산
- ex: `=ARRAYFORMULA(A2:A * B2:B)`
- `IF`, `VLOOKUP` 등과 결합해 자동화

### **📌 MODE**

- 최빈값 찾기.
- ex: `=MODE(A2:A10)`

### **📌 MATCH**

- 값의 위치 찾기.
- ex: `=MATCH("전자제품", A2:A10, 0)`

### **📌 FILTER**

- 조건 만족하는 데이터만 추출.
- ex: `=FILTER(A2:C10, B2:B10="전자제품")`

### **📌 윈저화 (Winsorizing)**

- 극단값 경계값으로 대체.
- `PERCENTILE` 함수 + `IF` 조건
- ex: 상위 5% → 95% 지점 값으로