# ✅ 구글 스프레드시트 실습

### **🗂️ 1단계: 문제가 있는 성적 데이터 준비**

**새 시트 "이상값_탐지" 생성:**

| A | B | C | D |
| --- | --- | --- | --- |
| 학번 | 학생명 | 수학점수 | 영어점수 |
| 2024001 | 김철수 | 85 | 78 |
| 2024002 | 이영희 | 92 | 88 |
| 2024003 | 박민수 | 78 | 82 |
| 2024004 | 최지은 | 88 | 95 |
| 2024005 | 정다현 | 76 | 80 |
| 2024006 | 한민지 | 94 | 85 |
| 2024007 | 오성민 | 82 | 79 |
| 2024008 | 윤서연 | 89 | 91 |
| 2024009 | 장혜진 | 15 | 87 |
| 2024010 | 신동욱 | 91 | 12 |
| 2024011 | 류지훈 | 87 | 83 |
| 2024012 | 문소영 | 185 | 89 |
| 2024013 | 강태우 | 83 | 86 |
| 2024014 | 홍유진 | 90 | 94 |
| 2024015 | 조현우 | 79 | 88 |

**🔍 눈으로 보이는 이상값:**

- 장혜진: 수학 15점 (너무 낮음)
- 신동욱: 영어 12점 (너무 낮음)
- 문소영: 수학 185점 (100점 초과, 입력 오류)

---

### **📊 2단계: 기본 통계량 계산**

**F1부터 기본 통계 계산:**

| F | G |
| --- | --- |
| **수학 통계** | ㅤ |
| 평균 | =AVERAGE(C2:C16) |
| 표준편차 | =STDEV(C2:C16) |
| 최댓값 | =MAX(C2:C16) |
| 최솟값 | =MIN(C2:C16) |
| 중간값 | =MEDIAN(C2:C16) |

**H1부터 영어 통계:**

| H | I |
| --- | --- |
| **영어 통계** | ㅤ |
| 평균 | =AVERAGE(D2:D16) |
| 표준편차 | =STDEV(D2:D16) |
| 최댓값 | =MAX(D2:D16) |
| 최솟값 | =MIN(D2:D16) |
| 중간값 | =MEDIAN(D2:D16) |

---

### **🧮 3단계: Z-Score 계산 (표준화 점수)**

**Z-Score 공식:**

```

Z = (개별값 - 평균) / 표준편차

```

**E1: "수학_Z점수", E2:**

```

=(C2-$G$2)/$G$3

```

**→ 절대참조 사용해서 아래로 복사**

**F1: "영어_Z점수", F2:**

```

=(D2-$I$2)/$I$3

```

---

### **🚩 4단계: 이상값 판정 기준 설정**

**일반적인 이상값 판정 기준:**

- **보수적**: |Z-Score| > 2 (95% 신뢰구간 벗어남)
- **일반적**: |Z-Score| > 2.5
- **엄격한**: |Z-Score| > 3 (99.7% 신뢰구간 벗어남)

**G1: "수학_이상값판정", G2:**

```

=IF(ABS(E2)>2.5,"이상값","정상")

```

**H1: "영어_이상값판정", H2:**

```

=IF(ABS(F2)>2.5,"이상값","정상")

```

---

### **🎨 5단계: 조건부 서식으로 이상값 시각화**

**이상값을 빨간색으로 표시:**

1. **C2:C16 선택** (수학점수)
2. **형식** → **조건부 서식**
3. **사용자 지정 수식**: `=ABS((C2-$G$2)/$G$3)>2.5`
4. **서식**: 빨간색 배경
5. **완료**

**영어점수도 동일하게 적용:**

- **D2:D16 선택**
- **수식**: `=ABS((D2-$I$2)/$I$3)>2.5`

---

### **🔢 6단계: 이상값 개수 및 비율 계산**

**K1부터 이상값 분석:**

| K | L |
| --- | --- |
| **이상값 분석** | ㅤ |
| 수학 이상값 개수 | =COUNTIF(G2:G16,"이상값") |
| 영어 이상값 개수 | =COUNTIF(H2:H16,"이상값") |
| 전체 학생 수 | =COUNT(C2:C16) |
| 수학 이상값 비율 | =L2/L4*100&"%" |
| 영어 이상값 비율 | =L3/L4*100&"%" |

---

### **📋 7단계: 이상값 목록 추출**

**M1: "이상값_학생_목록"**

**수학 이상값 학생:**

```

=FILTER(A2:D16,ABS((C2:C16-$G$2)/$G$3)>2.5)

```

**💡 FILTER 함수가 없는 경우 대안:** N1: "수학이상값_학번", N2:

```

=IF(G2="이상값",A2,"")

```

---

## **💰 실습 28: 매출 데이터 이상값 처리**

### **🗓️ 1단계: 일일 매출 데이터 준비**

**새 시트 "매출_이상값" 생성:**

| A | B | C |
| --- | --- | --- |
| 날짜 | 매출액(만원) | 주문건수 |
| 2024-01-01 | 520 | 45 |
| 2024-01-02 | 480 | 42 |
| 2024-01-03 | 510 | 47 |
| 2024-01-04 | 495 | 44 |
| 2024-01-05 | 8500 | 48 |
| 2024-01-06 | 505 | 46 |
| 2024-01-07 | 15 | 43 |
| 2024-01-08 | 525 | 49 |
| 2024-01-09 | 490 | 168 |
| 2024-01-10 | 515 | 45 |
| 2024-01-11 | 485 | 41 |
| 2024-01-12 | 500 | 46 |
| 2024-01-13 | 7800 | 47 |
| 2024-01-14 | 520 | 44 |
| 2024-01-15 | 495 | 48 |

---

### **📉 2단계: 매출액 이상값 탐지**

**D1: "매출_Z점수", D2:**

```

=(B2-AVERAGE($B$2:$B$16))/STDEV($B$2:$B$16)

```

**E1: "매출_이상값판정", E2:**

```

=IF(ABS(D2)>2,"이상값","정상")

```

**F1: "주문건수_Z점수", F2:**

```

=(C2-AVERAGE($C$2:$C$16))/STDEV($C$2:$C$16)

```

**G1: "주문_이상값판정", G2:**

```

=IF(ABS(F2)>2,"이상값","정상")

```

---

### **🔀 3단계: 이상값 처리 방법별 비교**

### **방법 1: 이상값 제거 (삭제)**

**H1: "정상값만_매출", H2:**

```

=IF(E2="정상",B2,"")

```

**I1: "제거후_평균"**

```

=AVERAGE(H2:H16)

```

### **방법 2: 이상값을 평균으로 대체**

**J1: "평균대체_매출", J2:**

```

=IF(E2="이상값",AVERAGE($B$2:$B$16),B2)

```

**K1: "평균대체후_평균"**

```

=AVERAGE(J2:J16)

```

### **방법 3: 이상값을 중간값으로 대체**

**L1: "중간값대체_매출", L2:**

```

=IF(E2="이상값",MEDIAN($B$2:$B$16),B2)

```

**M1: "중간값대체후_평균"**

```

=AVERAGE(L2:L16)

```

### **방법 4: 윈저화(Winsorizing) - 상하위 5%를 경계값으로 대체**

**N1: "윈저화_매출", N2:**

```

=IF(B2>PERCENTILE($B$2:$B$16,0.95),PERCENTILE($B$2:$B$16,0.95),
   IF(B2<PERCENTILE($B$2:$B$16,0.05),PERCENTILE($B$2:$B$16,0.05),B2))

```

---

### **⚖️ 4단계: 처리 방법별 결과 비교**

**P1부터 결과 비교표:**

| P | Q |
| --- | --- |
| **처리방법별 비교** | ㅤ |
| 원본 평균 | =AVERAGE(B2:B16) |
| 원본 표준편차 | =STDEV(B2:B16) |
| ㅤ | ㅤ |
| 이상값제거 평균 | =I2 |
| 이상값제거 표준편차 | =STDEV(H2:H16) |
| ㅤ | ㅤ |
| 평균대체 평균 | =K2 |
| 평균대체 표준편차 | =STDEV(J2:J16) |
| ㅤ | ㅤ |
| 중간값대체 평균 | =M2 |
| 중간값대체 표준편차 | =STDEV(L2:L16) |
| ㅤ | ㅤ |
| 윈저화 평균 | =AVERAGE(N2:N16) |
| 윈저화 표준편차 | =STDEV(N2:N16) |